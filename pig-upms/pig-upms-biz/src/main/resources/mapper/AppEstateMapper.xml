<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pig4cloud.pig.admin.mapper.AppEstateMapper">

	<resultMap id="appEstateMap" type="com.pig4cloud.pig.admin.api.entity.AppEstateEntity">
		<id property="estateId" column="estate_id"/>
		<id property="estateName" column="estate_name"/>
		<id property="estateFloor" column="estate_floor"/>
		<id property="estateCode" column="estate_code"/>
		<id property="estateDistrictCode" column="estate_district_code"/>
		<id property="estateAddress" column="estate_address"/>
		<id property="estateAreaLand" column="estate_area_land"/>
		<id property="estateAreaLandcertificate" column="estate_area_landcertificate"/>
		<id property="estateAreaEstate" column="estate_area_estate"/>
		<id property="estateAreaEstatecertificate" column="estate_area_estatecertificate"/>
		<id property="yjqyId" column="yjqy_id"/>
		<id property="qsdwId" column="qsdw_id"/>
		<id property="estateLandstatusId" column="estate_landstatus_id"/>
		<id property="estateEstatetypeId" column="estate_estatetype_id"/>
		<id property="estateEstatefunctionId" column="estate_estatefunction_id"/>
		<id property="createBy" column="create_by"/>
		<id property="createTime" column="create_time"/>
		<id property="updateBy" column="update_by"/>
		<id property="updateTime" column="update_time"/>
	</resultMap>

	<resultMap id="estateVoMap" type="com.pig4cloud.pig.admin.api.vo.EstateVO">
		<id property="estateId" column="estate_id"/>
		<result property="estateName" column="estate_name"/>
		<result property="estateFloor" column="estate_floor"/>
		<result property="estateCode" column="estate_code"/>
		<result property="districtName" column="district_name"/>
		<result property="estateAddress" column="estate_address"/>
		<result property="estateAreaLand" column="estate_area_land"/>
		<result property="estateAreaLandcertificate" column="estate_area_landcertificate"/>
		<result property="estateAreaEstate" column="estate_area_estate"/>
		<result property="estateAreaEstatecertificate" column="estate_area_estatecertificate"/>
		<result property="yjqyName" column="yjqy_name"/>
		<result property="qsdwName" column="qsdw_name"/>
		<result property="landstatusName" column="landstatus_name"/>
		<result property="estatetypeName" column="estatetype_name"/>
		<result property="estatefunctionName" column="estatefunction_name"/>
	</resultMap>

	<resultMap id="estateSuiteVoMap" type="com.pig4cloud.pig.admin.api.vo.EstateSuiteVO">
		<id property="estateId" column="estate_id"/>
		<result property="estateName" column="estate_name"/>
		<result property="estateFloor" column="estate_floor"/>
		<result property="estateCode" column="estate_code"/>
		<result property="districtName" column="district_name"/>
		<result property="estateAddress" column="estate_address"/>
		<result property="estateAreaLand" column="estate_area_land"/>
		<result property="estateAreaLandcertificate" column="estate_area_landcertificate"/>
		<result property="estateAreaEstate" column="estate_area_estate"/>
		<result property="estateAreaEstatecertificate" column="estate_area_estatecertificate"/>
		<result property="yjqyName" column="yjqy_name"/>
		<result property="qsdwName" column="qsdw_name"/>
		<result property="landstatusName" column="landstatus_name"/>
		<result property="estatetypeName" column="estatetype_name"/>
		<result property="estatefunctionName" column="estatefunction_name"/>
		<collection property="suiteEntityList" ofType="com.pig4cloud.pig.admin.api.entity.AppSuiteEntity"
					select="com.pig4cloud.pig.admin.mapper.AppSuiteMapper.listSuitesByEstateId" column="estate_id">
		</collection>
	</resultMap>


	<select id="getEstateVosPage" resultMap="estateVoMap">
		SELECT
		app_estate.estate_id,
		app_estate.estate_name,
		app_estate.estate_floor,
		app_estate.estate_code,
		app_district.district_name,
		app_estate.estate_address,
		app_estate.estate_area_land,
		app_estate.estate_area_landcertificate,
		app_estate.estate_area_estate,
		app_estate.estate_area_estatecertificate,
		app_yjqy.yjqy_name,
		app_qsdw.qsdw_name,
		app_landstatus.landstatus_name,
		app_estatetype.estatetype_name,
		app_estatefunction.estatefunction_name
		FROM app_estate
		LEFT JOIN app_district ON app_estate.estate_district_code = app_district.district_code
		LEFT JOIN app_yjqy ON app_estate.yjqy_id = app_yjqy.yjqy_id
		LEFT JOIN app_qsdw ON app_estate.qsdw_id = app_qsdw.qsdw_id
		LEFT JOIN app_estatefunction ON app_estate.estate_estatefunction_id = app_estatefunction.estatefunction_id
		LEFT JOIN app_estatetype ON app_estate.estate_estatetype_id = app_estatetype.estatetype_id
		LEFT JOIN app_landstatus ON app_estate.estate_landstatus_id = app_landstatus.landstatus_id
		<where>
			app_estate.estate_id != 0
			<if test="query.estateName != null and query.estateName != ''">
				<bind name="estateNameLike" value="'%'+query.estateName+'%'"/>
				AND app_estate.estate_name LIKE #{estateNameLike}
			</if>
			<if test="query.yjqyId != null and query.yjqyId != ''">
				AND app_estate.yjqy_id = #{query.yjqyId}
			</if>
			<if test="query.qsdwId != null and query.qsdwId != ''">
				AND app_estate.qsdw_id = #{query.qsdwId}
			</if>
			<if test="query.estateEstatefunctionId != null and query.estateEstatefunctionId != ''">
				AND app_estate.estate_estatefunction_id = #{query.estateEstatefunctionId}
			</if>
			<if test="query.estateEstatetypeId != null and query.estateEstatetypeId != ''">
				AND app_estate.estate_estatetype_id = #{query.estateEstatetypeId}
			</if>
			<if test="query.estateLandstatusId != null and query.estateLandstatusId != ''">
				AND app_estate.estate_landstatus_id = #{query.estateLandstatusId}
			</if>
		</where>

		<if test="_databaseId != 'mssql'">
			ORDER BY app_estate.estate_id ASC
		</if>
	</select>

	<select id="getEstateSuiteVosPage" resultMap="estateSuiteVoMap">
		SELECT
		app_estate.estate_id,
		app_estate.estate_name,
		app_estate.estate_floor,
		app_estate.estate_code,
		app_district.district_name,
		app_estate.estate_address,
		app_estate.estate_area_land,
		app_estate.estate_area_landcertificate,
		app_estate.estate_area_estate,
		app_estate.estate_area_estatecertificate,
		app_yjqy.yjqy_name,
		app_qsdw.qsdw_name,
		app_landstatus.landstatus_name,
		app_estatetype.estatetype_name,
		app_estatefunction.estatefunction_name
		FROM app_estate
		LEFT JOIN app_district ON app_estate.estate_district_code = app_district.district_code
		LEFT JOIN app_yjqy ON app_estate.yjqy_id = app_yjqy.yjqy_id
		LEFT JOIN app_qsdw ON app_estate.qsdw_id = app_qsdw.qsdw_id
		LEFT JOIN app_estatefunction ON app_estate.estate_estatefunction_id = app_estatefunction.estatefunction_id
		LEFT JOIN app_estatetype ON app_estate.estate_estatetype_id = app_estatetype.estatetype_id
		LEFT JOIN app_landstatus ON app_estate.estate_landstatus_id = app_landstatus.landstatus_id
		<where>
			app_estate.estate_id != 0
			<if test="query.estateName != null and query.estateName != ''">
				<bind name="estateNameLike" value="'%'+query.estateName+'%'"/>
				AND app_estate.estate_name LIKE #{estateNameLike}
			</if>
			<if test="query.yjqyId != null and query.yjqyId != ''">
				AND app_estate.yjqy_id = #{query.yjqyId}
			</if>
			<if test="query.qsdwId != null and query.qsdwId != ''">
				AND app_estate.qsdw_id = #{query.qsdwId}
			</if>
			<if test="query.estateEstatefunctionId != null and query.estateEstatefunctionId != ''">
				AND app_estate.estate_estatefunction_id = #{query.estateEstatefunctionId}
			</if>
			<if test="query.estateEstatetypeId != null and query.estateEstatetypeId != ''">
				AND app_estate.estate_estatetype_id = #{query.estateEstatetypeId}
			</if>
			<if test="query.estateLandstatusId != null and query.estateLandstatusId != ''">
				AND app_estate.estate_landstatus_id = #{query.estateLandstatusId}
			</if>
		</where>

		<if test="_databaseId != 'mssql'">
			ORDER BY app_estate.estate_id ASC
		</if>
	</select>
</mapper>